â– dockerã‚’ä½¿ã£ã¦netboxã‚’Verupã—ã¦DBã‚‚ä¸€ç·’ã«upgradeã•ã‚Œã¦ã„ãäº‹ã«æœŸå¾…
mkdir netbox-verup
cd netbox-verup
docker-compose.yamlã‚’ä½œæˆ

â– åˆå›èµ·å‹•
docker compose up -d
docker compose logs -f netbox

â– ãƒ‡ãƒ¼ã‚¿ãƒªã‚¹ãƒˆã‚¢
cd ~/netbox
docker compose down
docker exec -it netbox-postgres psql -U netbox -d postgres -c "
DROP DATABASE netbox;
CREATE DATABASE netbox OWNER netbox;

â– AKSã‹ã‚‰å–å¾—ã—ãŸæœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
docker exec -i netbox-postgres psql -U netbox netbox < netbox_v3.2.7_20260101.sql

â– docker-compose.yamlã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¤‰æ›´ã—ã¦å®Ÿæ–½
docker compose down
docker compose up -d

â– èµ·å‹•ç¢ºèª(dbã®èª­ã¿è¾¼ã¿ã«æ™‚é–“ãŒã‹ã‹ã‚‹)
docker compose logs -f netbox

â– imageã‚’ä»¥ä¸‹ã«å¤‰ãˆã¦å®Ÿè¡Œã—ã¦ã
image: netboxcommunity/netbox:v3.5.9 / postgress 13
image: netboxcommunity/netbox:v3.7.8 / postgress 13
image: netboxcommunity/netbox:v4.0.11 / postgress 15
image: netboxcommunity/netbox:v4.5.1 / postgress 15

â– netbox ver4.5.1ã§ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker exec -t netbox-postgres pg_dump -U netbox netbox > netbox_v4.5.1_20260101.sql

â– ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’AKS netbox-newã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹
â– ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–(ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å–å¾—å¾Œã«)
cd ~/netbox
docker compose down
docker exec -it netbox-postgres psql -U netbox -d postgres -c "
DROP DATABASE netbox;
CREATE DATABASE netbox OWNER netbox;

â– AKSã«ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
docker exec -i netbox-postgres psql -U netbox netbox < netbox_v4.5.1_20260101.sql

dockerã®dbã‚’k8sã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ¡ä»¶
â‘  NetBox ãƒãƒ¼ã‚¸ãƒ§ãƒ³
Docker å´ï¼šNetBox 4.5.1
k8s å´ï¼šNetBox 4.5.1
ğŸ‘‰ å®Œå…¨ä¸€è‡´ãŒåŸå‰‡ï¼ˆ4.5.x åŒå£«ãªã‚‰å¯ï¼‰

â‘¡ PostgreSQL ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³
Docker å´ï¼šPostgreSQL 14 or 15

âŒ PostgreSQL 13 ã®ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’
âŒ PostgreSQL 15 ã§ãã®ã¾ã¾ä½¿ãŠã†ã¨ã—ã¦ã„ã‚‹

13 -> 15ã«verupã™ã‚‹æ™‚
docker volume rm netbox_postgres_data
docker volume ls
docker compose up -d postgres
docker compose ps
docker compose logs postgres
2026-01-21 11:25:02.718 UTC [1] LOG:  database system is ready to accept connections

docker exec -it netbox-postgres psql -U netbox -d postgres -c "DROP DATABASE netbox;"
docker exec -it netbox-postgres psql -U netbox -d postgres -c "CREATE DATABASE netbox OWNER netbox;"
docker exec -i netbox-postgres psql -U netbox netbox < netbox_full_327.sql

docker compose up -d netbox
docker compose logs -f netbox

python3 - <<'PY'
import secrets
print(secrets.token_urlsafe(50))
PY




docker network prune -f
